<div class="flex flex-col p-6">
  <div class="font-bold text-3xl">Goals</div>
  <div class="flex justify-between space-x-8 mt-8">
    <div
      class="flex justify-center items-center cursor-pointer"
      (click)="toggleGoalForm()"
    >
      <span
        class="text-4xl rounded-full bg-green w-11 h-11 items-center flex my-auto justify-center pb-1"
        >+</span
      >
      <span class="arrow-left"></span>
      <span class="text-xl rounded-lg py-2 px-4 bg-white text-black"
        >Add a goal</span
      >
    </div>
    <div
      class="bg-danger rounded-lg flex justify-center items-center cursor-pointer"
      *ngIf="!showGoalsForm"
    >
      <div class="mx-auto px-4 py-2 space-x-2">
        <span class="text-2xl rounded-full"
          ><i class="fa fa-trash-alt"></i
        ></span>
        <span class="text-xl rounded-lg">Delete all</span>
      </div>
    </div>
  </div>
</div>
<ng-container *ngIf="showGoalsForm">
  <form [formGroup]="goalsForm" (ngSubmit)="onSubmit(goalsForm.value)">
    <div class="space-x-1">
      <div class="text-2xl flex flex-wrap p-6">
        <div class="w-1/3 pr-2">
          <label class="block text-gray-700 font-bold mb-2" for="title">
            Title
          </label>
          <input
            type="text"
            id="title"
            class="w-full px-3 py-2 border text-black dark:text-primary rounded-lg"
            [disabled]="isFieldDisabled"
            formControlName="title"
          />
        </div>
      </div>

      <div class="text-2xl grid grid-cols-4 gap-6 p-6">
        <div class="">
          <label class="block text-gray-700 font-bold mb-2" for="startDate">
            Start Date
          </label>
          <input
            id="startDate"
            type="date"
            class="w-full px-3 py-2 border text-black dark:text-primary rounded-lg"
            formControlName="startDate"
          />
        </div>
        <div class="">
          <label class="block text-gray-700 font-bold mb-2" for="endDate">
            End Date
          </label>
          <input
            id="endDate"
            type="date"
            class="w-full px-3 py-2 border text-black dark:text-primary rounded-lg"
            formControlName="endDate"
          />
        </div>
        <div class="">
          <label class="block text-gray-700 font-bold mb-2" for="target">
            Target
          </label>
          <input
            id="target"
            type="number"
            class="w-full px-3 py-2 border text-black dark:text-primary rounded-lg"
            formControlName="target"
          />
        </div>
        <div class="">
          <label class="block text-gray-700 font-bold mb-2" for="saving">
            Saving
          </label>
          <input
            id="saving"
            type="number"
            class="w-full px-3 py-2 border text-black dark:text-primary rounded-lg"
            formControlName="saving"
          />
        </div>
      </div>

      <div class="text-2xl p-6">
        <label class="block text-gray-700 font-bold mb-2" for="description">
          Description
        </label>
        <textarea
          type="text"
          id="description"
          class="w-full px-3 py-2 border text-black dark:text-primary rounded-lg"
          formControlName="description"
        ></textarea>
      </div>
    </div>

    <div class="flex justify-center">
      <button type="submit" class="bg-green px-4 py-2 rounded-lg text-2xl">
        Add goal
      </button>
    </div>
  </form>
</ng-container>

<!-- ------------------------------------------------------------ -->
<!-- 
<p>Arjun Jain</p> -->

<ng-container *ngIf="showUpdateGoalsForm">
  <form
    [formGroup]="updateGoalsForm"
    (ngSubmit)="onUpdateGoal(updateGoalsForm.value)"
  >
    <div class="space-x-1">
      <div class="text-2xl flex flex-wrap p-6">
        <div class="w-1/3 pr-2">
          <label class="block text-gray-700 font-bold mb-2" for="title">
            Title
          </label>
          <input
            [value]="myGoal.title"
            type="text"
            id="uTitleField"
            class="w-full px-3 py-2 border text-black dark:text-primary rounded-lg"
            disabled
          />
        </div>
      </div>

      <div class="text-2xl grid grid-cols-4 gap-6 p-6">
        <div class="">
          <label class="block text-gray-700 font-bold mb-2" for="startDate">
            Start Date
          </label>
          <input
            [value]="myGoal.startDate"
            id="uStartDateField"
            type="date"
            class="w-full px-3 py-2 border text-black dark:text-primary rounded-lg"
            disabled
          />
        </div>
        <div class="">
          <label class="block text-gray-700 font-bold mb-2" for="endDate">
            End Date
          </label>
          <input
            formControlName="endDate"
            id="uEndDateField"
            type="date"
            class="w-full px-3 py-2 border text-black dark:text-primary rounded-lg"
          />
        </div>
        <div class="">
          <label class="block text-gray-700 font-bold mb-2" for="target">
            Target
          </label>
          <input
            formControlName="target"
            id="uTargetField"
            type="number"
            class="w-full px-3 py-2 border text-black dark:text-primary rounded-lg"
          />
        </div>
        <div class="">
          <label class="block text-gray-700 font-bold mb-2" for="saving">
            Saving
          </label>
          <input
            formControlName="saving"
            id="uSavingField"
            type="number"
            class="w-full px-3 py-2 border text-black dark:text-primary rounded-lg"
          />
        </div>
      </div>

      <div class="text-2xl p-6">
        <label class="block text-gray-700 font-bold mb-2" for="description">
          Description
        </label>
        <textarea
          formControlName="description"
          type="text"
          id="uDescriptionField"
          class="w-full px-3 py-2 border text-black dark:text-primary rounded-lg"
        ></textarea>
      </div>
    </div>

    <div class="flex justify-center">
      <button type="submit" class="bg-green px-4 py-2 rounded-lg text-2xl">
        Update goal
      </button>
    </div>
  </form>
</ng-container>

<!-- -------------------------------------------- -->

<div class="grid grid-row-{{ totalGoals }} p-6">
  <ng-container *ngFor="let goal of goals; let i = index">
    <div
      class="bg-[#227C70] flex flex-col p-[20px] justify-start rounded-xl items-center mt-10"
    >
      <div class="items-start">
        <h1
          class="text-3xl font-bold justify-start flex flex-col items-start mx-auto"
        >
          <span class="font-mono">{{ goal.title }}</span>

          <span class="mt-3 text-sm font-merriweather">
            Target : {{ goal.target }}
          </span>
        </h1>
      </div>

      <span
        class="text-[10px] ml-2 mt-[5px] text-sm text-white flex justify-start w-full"
      >
        <!-- <ng-container *ngIf="updateProgressBar(goal.target,goal.savings) < 0;">
          *set budget is lower than the spent value
        </ng-container> -->
        <ng-container *ngIf="updateProgressBar(goal.target, goal.saving) >= 0">
          Saved: {{ goal.saving }}
        </ng-container>
      </span>


      <div
        class="bg-[#227C70] h-[{{
          goal.description.length
        }}] flex flex-col p-[20px] justify-start rounded-xl items-center mt-10"
      >

        <div
          class="h-[10px] flex justify-center text-center items-center text-xs font-medium text-primary-100 rounded-xl"
          [style.width.%]="updateProgressBar(goal.target, goal.saving)"
          [style.backgroundColor]="getColor(goal.target, goal.saving)"
        ></div>
      </div>

      <div
        type="button"
        class="text-white font-bold rounded mt-3 flex justify-end w-full"
        (click)="toggleDescription(i)"
      >
        <span class="flex w-full items-center cursor-pointer ml-1">
          <ng-container *ngIf="!showingDes[i]"
            >Show More <span class="mb-2 ml-2"> ⌄</span></ng-container
          >
          <ng-container *ngIf="showingDes[i]"
            >Show Less <span class="mt-2 ml-3"> ⌃</span></ng-container
          >
        </span>
        <button (click)="updateGoal(goal, i)" class="">
          <p
            class="cursor-pointer text-white bg-info hover:bg-[#1366a1] rounded-md p-1 px-2 text-[15px] border border-white shadow-button"
          >
            Update
          </p>
        </button>
      </div>
      <div
        *ngIf="showingDes[i]"
        class="flex justify-start flex-row items-start mt-4 w-full"
      >
        <p class="w-1/3 text-justify font-mono ml-1">
          Description: {{ goal.description }}
        </p>
        <span class="flex flex-col justify center ml-[150px] font-mono">
          <p>Start Date: {{ goal.startDate }}</p>
          <p class="mt-3">End Date: {{ goal.endDate }}</p>

        </span>
  
        <div
          class="h-[10px] mt-[1px] w-full bg-black dark:bg-black justify-start align-start rounded-xl"
        >
          <div
            class="h-[10px] flex justify-center text-center items-center text-xs font-medium text-primary-100 rounded-xl"
            [style.width.%]="updateProgressBar(goal.target, goal.saving)"
            [style.backgroundColor]="getColor(goal.target, goal.saving)"
          ></div>
        </div>
  
        <button
          class="text-white font-bold rounded mt-3"
          (click)="toggleDescription(i)"
        >
          <span class="flex justify center w-full items-center"
            >
            <ng-container *ngIf="!showingDes[i]">Show More <span class="mb-2 ml-2">  ⌄</span></ng-container>
            <ng-container *ngIf="showingDes[i]">Show Less <span class="mt-2 ml-2"> ⌃</span></ng-container>
            </span
          >
          </button>
          <div *ngIf="showingDes[i]"  class="flex justify-start flex-row items-start mt-4 w-full">
          <p class="w-1/3 text-justify">Description: {{ goal.description }}</p>
          <span class="flex flex-col justify center ml-[150px]">
            <p>Start Date: {{ goal.startDate }}</p>
            <p class="mt-3">End Date: {{ goal.endDate }}</p>
          </span>
        </div>
  
        <!-- <div class="mt-10 mx-auto w-full items-center justify-center flex">
          <div class="flex space-x-4 w-full mx-auto justify-center" *ngIf="budgetCategory.food == null">
            <p *ngIf="isFoodGreater" class="text-white font-medium">*set budget is less than <br><span class="ml-2">the spent value</span> </p>
            <input
              id="addFieldFood"
              [(ngModel)]="foodBudget"
              type="text"
              class="px-3 py-2 text-black rounded-md caret-black w-56 shadow-button"
              placeholder="Enter Budget"
            />
  
            <button
              
              (click)="setBudget('Food', foodBudget,'addFieldFood')"
              class=" rounded-sm"
            >
              <p  class="cursor-pointer text-white bg-[#7C9070] hover:bg-[#9CA777] rounded-md p-1 px-2 text-[15px]  shadow-button">
                Add Budget
                </p>
            </button>
          </div>
          <div *ngIf="budgetCategory.food != null" class="flex space-x-4">
            <p
              *ngIf="!isFoodUpdateShowing"
              (click)="doToggle('Food')"
              class="cursor-pointer text-white bg-info hover:bg-[#1366a1] rounded-md p-1 px-2 text-[15px] border border-white shadow-button"
            >
              Update<span><i class="fa fa-pen-to-square ml-2"></i></span>
            </p>
  
            <div class="flex space-x-4 w-full" *ngIf="isFoodUpdateShowing">
              <p *ngIf="isFoodGreater" class="text-white font-medium">*set budget is less than <br><span class="ml-2">the spent value</span> </p>
              <input
                id="updateFoodBudgetBox"
                [(ngModel)]="updatedFoodBudget"
                type="text"
                class="px-3 py-2 text-black rounded-md caret-black w-56 shadow-button"
                placeholder="Enter Budget"
              />
              <button
                (click)="updateBudget('Food', updatedFoodBudget,'updateFoodBudgetBox')"
              
              >
                <p class="cursor-pointer text-white bg-info hover:bg-[#1366a1] rounded-md p-1 px-2 text-[15px] border border-white shadow-button">Update</p>
              </button>
            </div>
  
            <p
              *ngIf="!isFoodUpdateShowing"
              (click)="deleteBudget('Food')"
              class="cursor-pointer text-white bg-danger hover:bg-[#ab2b11] shadow-button border border-white rounded-md p-1 px-3 text-[15px]"
            >
              Delete<span><i class="fa fa-trash-alt ml-2"></i></span>
            </p>
          </div>
        </div>
      </div> -->
      </div>
    </ng-container>
  </div>
  
</ng-container>